{$layout}
{$template "header"}
<style>
    .stat-segment {
        border-left: 4px solid;
        transition: all 0.3s ease;
    }
    .stat-segment:hover {
        transform: translateY(-2px);
        box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    }
    .stat-segment.blue { border-color: #2185d0; }
    .stat-segment.green { border-color: #21ba45; }
    .stat-segment.purple { border-color: #a333c8; }
    .stat-segment.orange { border-color: #f2711c; }

    .quick-action-card {
        transition: all 0.2s ease;
        cursor: pointer;
    }
    .quick-action-card:hover {
        transform: translateY(-2px);
        box-shadow: 0 4px 8px rgba(0,0,0,0.1);
    }
</style>
{$end}

<!-- 页面标题 -->
<div class="ui basic segment">
    <h2 class="ui header">
        <i class="dashboard icon"></i>
        <div class="content">
            仪表盘
            <div class="sub header">欢迎回来，{$.teaUsername}</div>
        </div>
    </h2>
</div>

<!-- 统计卡片 -->
<div class="ui four stackable cards">
    <!-- 总域名数 -->
    <div class="ui card stat-segment blue">
        <div class="content">
            <div class="ui right floated">
                <i class="big globe icon" style="color: #2185d0;"></i>
            </div>
            <div class="header" style="color: #2185d0; font-size: 2em; margin-top: 0.5em;">
                {$.totalDomains}
            </div>
            <div class="meta">总域名数</div>
            <div class="description">
                <i class="green check circle icon"></i>
                <span style="color: #21ba45;">运行中 {$.activeDomains}</span>
            </div>
        </div>
    </div>

    <!-- 今日请求 -->
    <div class="ui card stat-segment green">
        <div class="content">
            <div class="ui right floated">
                <i class="big chart line icon" style="color: #21ba45;"></i>
            </div>
            <div class="header" style="color: #21ba45; font-size: 2em; margin-top: 0.5em;">
                {$.todayRequests}
            </div>
            <div class="meta">今日请求</div>
            <div class="description">
                <i class="green arrow up icon"></i>
                <span style="color: #21ba45;">↑ 12.5% vs 昨日</span>
            </div>
        </div>
    </div>

    <!-- 今日流量 -->
    <div class="ui card stat-segment purple">
        <div class="content">
            <div class="ui right floated">
                <i class="big cloud download icon" style="color: #a333c8;"></i>
            </div>
            <div class="header" style="color: #a333c8; font-size: 2em; margin-top: 0.5em;">
                {$.todayTraffic}
            </div>
            <div class="meta">今日流量</div>
            <div class="description">
                <i class="blue info circle icon"></i>
                <span style="color: #2185d0;">总计 {$.totalTraffic}</span>
            </div>
        </div>
    </div>

    <!-- SSL证书 -->
    <div class="ui card stat-segment orange">
        <div class="content">
            <div class="ui right floated">
                <i class="big shield alternate icon" style="color: #f2711c;"></i>
            </div>
            <div class="header" style="color: #f2711c; font-size: 2em; margin-top: 0.5em;">
                {$.sslCerts}
            </div>
            <div class="meta">SSL证书</div>
            <div class="description">
                <i class="orange warning sign icon"></i>
                <span style="color: #f2711c;">{$.expiringSoon} 个即将过期</span>
            </div>
        </div>
    </div>
</div>

<!-- 图表和域名列表 -->
<div class="ui stackable two column grid" style="margin-top: 2em;">
    <div class="column">
        <!-- 流量趋势图 -->
        <div class="ui segment">
            <div class="ui two column grid">
                <div class="column">
                    <h3 class="ui header">
                        <i class="chart area icon"></i>
                        <div class="content">流量趋势</div>
                    </h3>
                </div>
                <div class="right aligned column">
                    <select class="ui compact selection dropdown">
                        <option>最近7天</option>
                        <option>最近30天</option>
                        <option>最近90天</option>
                    </select>
                </div>
            </div>

            <div class="ui divider"></div>

            <div id="trafficChart" style="height: 300px;">
                <div class="ui placeholder segment" style="height: 100%;">
                    <div class="ui icon header">
                        <i class="chart bar icon"></i>
                        图表加载中...
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="column">
        <!-- 我的域名 -->
        <div class="ui segment">
            <div class="ui two column grid">
                <div class="column">
                    <h3 class="ui header">
                        <i class="list icon"></i>
                        <div class="content">我的域名</div>
                    </h3>
                </div>
                <div class="right aligned column">
                    <a href="/user/domains" class="ui basic compact button">
                        查看全部 <i class="right arrow icon"></i>
                    </a>
                </div>
            </div>

            <div class="ui divider"></div>

            <div class="ui relaxed divided list">
                {$range $index, $domain := .domains}
                <div class="item">
                    <div class="ui small circular blue label">{$substr $domain.name 0 1}</div>
                    <div class="content">
                        <div class="header">{$domain.name}</div>
                        <div class="description">
                            <i class="chart line icon"></i> 请求: {$domain.requests}
                            <span class="ui green label" style="margin-left: 1em;">运行中</span>
                        </div>
                    </div>
                </div>
                {$end}
            </div>

            <a href="/user/domains/create" class="ui fluid button" style="margin-top: 1em;">
                <i class="plus icon"></i>
                添加新域名
            </a>
        </div>
    </div>
</div>

<!-- 快速操作 -->
<div class="ui segment" style="margin-top: 2em;">
    <h3 class="ui header">
        <i class="bolt icon"></i>
        <div class="content">快速操作</div>
    </h3>

    <div class="ui divider"></div>

    <div class="ui four stackable cards">
        <a href="/user/domains/create" class="ui card quick-action-card">
            <div class="content" style="text-align: center; padding: 2em;">
                <div class="ui blue circular huge label" style="margin-bottom: 1em;">
                    <i class="plus icon"></i>
                </div>
                <div class="header">添加域名</div>
            </div>
        </a>

        <a href="/user/stats" class="ui card quick-action-card">
            <div class="content" style="text-align: center; padding: 2em;">
                <div class="ui green circular huge label" style="margin-bottom: 1em;">
                    <i class="chart bar icon"></i>
                </div>
                <div class="header">查看统计</div>
            </div>
        </a>

        <a href="/user/domains" class="ui card quick-action-card">
            <div class="content" style="text-align: center; padding: 2em;">
                <div class="ui purple circular huge label" style="margin-bottom: 1em;">
                    <i class="cog icon"></i>
                </div>
                <div class="header">域名管理</div>
            </div>
        </a>

        <a href="/user/profile" class="ui card quick-action-card">
            <div class="content" style="text-align: center; padding: 2em;">
                <div class="ui orange circular huge label" style="margin-bottom: 1em;">
                    <i class="user icon"></i>
                </div>
                <div class="header">个人设置</div>
            </div>
        </a>
    </div>
</div>

{$template "footer"}
<script>
Tea.context(function() {
    // 初始化下拉菜单
    this.$delay(function() {
        $('.ui.dropdown').dropdown();
    });

    // TODO: 使用 ECharts 初始化流量趋势图
    // 需要加载 ECharts 库后实现
});
</script>
{$end}
