{$layout}
{$template "node_menu"}
{$template "/code_editor"}

<!-- æœªå®‰è£?-->
<div v-if="!node.isInstalled">
    <div>
        <span class="red">åœ¨å½“å‰èŠ‚ç‚¹å®Œæˆå®‰è£…å‰ï¼Œç›¸å…³DNSè§£æè®°å½•å°†ä¸ä¼šç”Ÿæ•ˆï¼Œ<link-red href="" @click.prevent="updateNodeIsInstalled(true)">å·²å®Œæˆå®‰è£?/link-red> ã€?/span>
        <div class="ui divider"></div>
    </div>

    <b-settings-header>æ–¹æ³•1ï¼šé€šè¿‡SSHè‡ªåŠ¨å®‰è£…</b-settings-header>
    <!-- <h4>æ–¹æ³•1ï¼šé€šè¿‡SSHè‡ªåŠ¨å®‰è£…</h4> -->

    <b-status-card>
        <b-status-card-item label="SSHåœ°å€" span="full">
            <span v-if="sshAddr.length > 0">{{sshAddr}} &nbsp; <a href="" @click.prevent="showSSHPopup(nodeId)">[ä¿®æ”¹]</a></span>
            <span v-else><span class="red">å°šæœªè®¾ç½®</span> &nbsp; <a href="" @click.prevent="showSSHPopup(nodeId)">[è®¾ç½®]</a></span>
        </b-status-card-item>
        <b-status-card-item label="å®‰è£…" span="full">
            <div v-if="installStatus != null && (installStatus.isRunning || installStatus.isFinished)" class="ui segment installing-box">
                <div v-if="installStatus.isRunning" class="blue">å®‰è£…ä¸?.</div>
                <div v-if="installStatus.isFinished">
                    <span v-if="installStatus.isOk" class="green">å·²å®‰è£…æˆåŠ?/span>
                    <span v-if="!installStatus.isOk" class="red">å®‰è£…è¿‡ç¨‹ä¸­å‘ç”Ÿé”™è¯¯ï¼š{{installStatus.error}}</span>
                </div>
            </div>
            <div v-if="installStatus != null && installStatus.isFinished">
                <button class="ui button small" type="button" @click.prevent="install()">é‡æ–°å®‰è£…</button>
            </div>
            <div v-if="installStatus == null || (!installStatus.isFinished && !installStatus.isRunning)">
                <button class="ui button small primary" type="button" @click.prevent="install()">å¼€å§‹å®‰è£?/button>
            </div>
        </b-status-card-item>
    </b-status-card>

    <div class="ui divider"></div>
    <a href="" @click.prevent="updateNodeIsInstalled(true)">[ä¿®æ”¹å½“å‰èŠ‚ç‚¹ä¸ºå·²å®‰è£…çŠ¶æ€]</a>
</div>

<!-- å·²å®‰è£?-->
<div v-if="node.isInstalled">
    <b-settings-header>é…ç½®æ–‡ä»¶</b-settings-header>
    <!-- <h4>é…ç½®æ–‡ä»¶</h4> -->

    <b-status-card>
        <b-status-card-item label="é…ç½®æ–‡ä»¶" span="full">
            configs/api_node.yaml  &nbsp; <download-link :v-element="'rpc-code'" :v-file="'api_node.yaml'">[ä¸‹è½½]</download-link>
        </b-status-card-item>
        <b-status-card-item label="é…ç½®å†…å®¹" span="full">
            <source-code-box id="rpc-code" type="text/yaml">rpc.endpoints: [ {{apiEndpoints}} ]
nodeId: "{{node.uniqueId}}"
secret: "{{node.secret}}"</source-code-box>
            <p class="comment">æ¯ä¸ªèŠ‚ç‚¹çš„é…ç½®æ–‡ä»¶å†…å®¹å‡ä¸ç›¸åŒï¼Œä¸èƒ½æ··ç”¨ã€?/p>
        </b-status-card-item>
        <b-status-card-item label="å®‰è£…ç›®å½•" span="full">
            <div v-if="node.installDir.length == 0">
                ä½¿ç”¨é›†ç¾¤è®¾ç½®
                <span v-if="node.cluster != null && node.cluster.installDir.length > 0">ï¼ˆ{{node.cluster.installDir}}ï¼?/span>
            </div>
            <span v-else>{{node.installDir}}</span>
        </b-status-card-item>
        <b-status-card-item v-if="exeRoot.length > 0" label="æœ€è¿‘è¿è¡Œç›®å½? span="full">
            {{exeRoot}}
        </b-status-card-item>
    </b-status-card>

    <div>
        <div class="ui message success">å½“å‰èŠ‚ç‚¹ä¸ºå·²å®‰è£…çŠ¶æ€ã€?/div>
        <a href="" @click.prevent="updateNodeIsInstalled(false)">[é‡æ–°å®‰è£…]</a>
    </div>
</div>
