# LingCDN ç”¨æˆ·ç«¯ Go ä»£ç è¯´æ˜

## ğŸ“ ç›®å½•ç»“æ„

```
internal/web/actions/user/
â”œâ”€â”€ init.go              # ç”¨æˆ·ç«¯è·¯ç”±æ€»æ³¨å†Œ
â”œâ”€â”€ index/
â”‚   â””â”€â”€ index.go         # ç”¨æˆ·ç™»å½•ï¼ˆ/userï¼‰
â”œâ”€â”€ dashboard/
â”‚   â””â”€â”€ index.go         # ç”¨æˆ·ä»ªè¡¨ç›˜ï¼ˆ/user/dashboardï¼‰
â”œâ”€â”€ domains/
â”‚   â””â”€â”€ index.go         # åŸŸåç®¡ç†ï¼ˆ/user/domainsï¼‰
â”œâ”€â”€ stats/
â”‚   â””â”€â”€ index.go         # ç»Ÿè®¡æ•°æ®ï¼ˆ/user/statsï¼‰
â”œâ”€â”€ profile/
â”‚   â””â”€â”€ index.go         # ä¸ªäººè®¾ç½®ï¼ˆ/user/profileï¼‰
â””â”€â”€ logout/
    â””â”€â”€ index.go         # é€€å‡ºç™»å½•ï¼ˆ/user/logoutï¼‰
```

## ğŸ”— è·¯ç”±åˆ—è¡¨

| è·¯ç”± | æ–¹æ³• | åŠŸèƒ½ | æ–‡ä»¶ |
|------|------|------|------|
| `/user` | GET | ç”¨æˆ·ç™»å½•é¡µé¢ | index/index.go |
| `/user` | POST | å¤„ç†ç™»å½• | index/index.go |
| `/user/dashboard` | GET | ç”¨æˆ·ä»ªè¡¨ç›˜ | dashboard/index.go |
| `/user/domains` | GET | åŸŸååˆ—è¡¨ | domains/index.go |
| `/user/domains/create` | GET/POST | æ·»åŠ åŸŸå | domains/index.go |
| `/user/domains/delete` | POST | åˆ é™¤åŸŸå | domains/index.go |
| `/user/stats` | GET | ç»Ÿè®¡æ•°æ® | stats/index.go |
| `/user/profile` | GET/POST | ä¸ªäººè®¾ç½® | profile/index.go |
| `/user/logout` | GET | é€€å‡ºç™»å½• | logout/index.go |

## ğŸ” è®¤è¯è¯´æ˜

### ç”¨æˆ·ç™»å½•

æ–‡ä»¶ï¼š`internal/web/actions/user/index/index.go`

```go
// ä¸´æ—¶æµ‹è¯•è´¦å·ï¼ˆæ­£å¼ç¯å¢ƒéœ€è¦å¯¹æ¥æ•°æ®åº“ï¼‰
username: user
password: 123456
```

ç™»å½•æˆåŠŸåä¼šè¯ä¸­å­˜å‚¨ï¼š
- `userId` - ç”¨æˆ·ID
- `username` - ç”¨æˆ·å
- `isUser` - æ ‡è®°ä¸ºç”¨æˆ·ç«¯ç™»å½•

### è®¤è¯ä¸­é—´ä»¶

æ¯ä¸ªéœ€è¦ç™»å½•çš„é¡µé¢éƒ½ä½¿ç”¨ï¼š
```go
Auth *actionutils.UserMustAuth `action:"user"`
```

è¿™ä¼šè‡ªåŠ¨éªŒè¯ç”¨æˆ·æ˜¯å¦ç™»å½•ï¼Œæœªç™»å½•ä¼šè·³è½¬åˆ° `/user`

## ğŸ“ æ ¸å¿ƒåŠŸèƒ½æ¨¡å—

### 1. ç”¨æˆ·ä»ªè¡¨ç›˜

**æ–‡ä»¶**: `dashboard/index.go`

**åŠŸèƒ½**:
- æ˜¾ç¤ºåŸŸåç»Ÿè®¡
- æ˜¾ç¤ºè¯·æ±‚é‡
- æ˜¾ç¤ºæµé‡ç»Ÿè®¡
- æ˜¾ç¤ºSSLè¯ä¹¦æ•°é‡

**TODO**: éœ€è¦ä» RPC è·å–çœŸå®æ•°æ®

### 2. åŸŸåç®¡ç†

**æ–‡ä»¶**: `domains/index.go`

**åŠŸèƒ½**:
- åˆ—å‡ºç”¨æˆ·çš„æ‰€æœ‰åŸŸå
- æ·»åŠ æ–°åŸŸå
- åˆ é™¤åŸŸå
- æŸ¥çœ‹åŸŸåçŠ¶æ€

**TODO**: éœ€è¦è°ƒç”¨ RPC API å®ç°å¢åˆ æ”¹æŸ¥

### 3. ç»Ÿè®¡æ•°æ®

**æ–‡ä»¶**: `stats/index.go`

**åŠŸèƒ½**:
- ä»Šæ—¥è¯·æ±‚ç»Ÿè®¡
- ä»Šæ—¥æµé‡ç»Ÿè®¡
- æœ¬å‘¨/æœ¬æœˆç»Ÿè®¡

**TODO**: éœ€è¦ä» RPC è·å–ç»Ÿè®¡æ•°æ®

### 4. ä¸ªäººè®¾ç½®

**æ–‡ä»¶**: `profile/index.go`

**åŠŸèƒ½**:
- æŸ¥çœ‹ä¸ªäººä¿¡æ¯
- ä¿®æ”¹é‚®ç®±
- ä¿®æ”¹æ‰‹æœºå·
- ä¿®æ”¹å¯†ç 

**TODO**: éœ€è¦è°ƒç”¨ RPC æ›´æ–°ç”¨æˆ·ä¿¡æ¯

## ğŸ”„ ä¸ç®¡ç†ç«¯çš„å¯¹åº”å…³ç³»

| åŠŸèƒ½ | ç”¨æˆ·ç«¯ï¼ˆ80ç«¯å£ï¼‰ | ç®¡ç†ç«¯ï¼ˆ7788ç«¯å£ï¼‰ |
|------|-----------------|-------------------|
| ç™»å½•é¡µé¢ | `/user` | `/` |
| ä»ªè¡¨ç›˜ | `/user/dashboard` | `/dashboard` |
| æœåŠ¡å™¨/åŸŸå | `/user/domains` | `/servers` |
| ç»Ÿè®¡æ•°æ® | `/user/stats` | `/servers/stats` |
| ä¸ªäººè®¾ç½® | `/user/profile` | `/settings/profile` |
| é€€å‡ºç™»å½• | `/user/logout` | `/logout` |

## ğŸš€ ç¼–è¯‘å’Œæµ‹è¯•

### 1. ç¼–è¯‘ç¨‹åº

```bash
cd /root/Lingadmin-master

# æ¸…ç†
rm -f ling-admin

# ç¼–è¯‘
CGO_ENABLED=0 GOOS=linux GOARCH=amd64 \
go build -ldflags "-s -w" -o ling-admin ./cmd/edge-admin

# æ£€æŸ¥æ˜¯å¦æˆåŠŸ
./ling-admin version
```

### 2. éƒ¨ç½²

```bash
# å¤åˆ¶åˆ°è¿è¡Œç›®å½•
cp ling-admin /opt/lingcdn/bin/ling-admin

# é‡å¯æœåŠ¡
/opt/lingcdn/bin/ling-admin stop
/opt/lingcdn/bin/ling-admin start
```

### 3. æµ‹è¯•è®¿é—®

```bash
# æµ‹è¯•ç”¨æˆ·ç«¯ç™»å½•é¡µ
curl http://localhost:80/user

# æµ‹è¯•ç®¡ç†ç«¯ç™»å½•é¡µ
curl http://localhost:7788
```

### 4. æµ‹è¯•ç™»å½•

ä½¿ç”¨æµè§ˆå™¨è®¿é—®ï¼š
- ç”¨æˆ·ç«¯: `http://your-ip:80/user`
- ç”¨æˆ·å: `user`
- å¯†ç : `123456`

ç™»å½•æˆåŠŸåä¼šè·³è½¬åˆ° `/user/dashboard`

## âš ï¸ æ³¨æ„äº‹é¡¹

1. **å½“å‰æ˜¯ä¸´æ—¶å®ç°**ï¼šå¾ˆå¤šåŠŸèƒ½ä½¿ç”¨äº†ä¸´æ—¶æ•°æ®ï¼Œéœ€è¦åç»­å¯¹æ¥ RPC API
2. **è®¤è¯é€»è¾‘**ï¼šç›®å‰ä½¿ç”¨ç¡¬ç¼–ç çš„æµ‹è¯•è´¦å·ï¼Œæ­£å¼ç¯å¢ƒéœ€è¦æ”¹ä¸ºæ•°æ®åº“éªŒè¯
3. **æƒé™æ§åˆ¶**ï¼šéœ€è¦ç¡®ä¿ç”¨æˆ·åªèƒ½è®¿é—®è‡ªå·±çš„èµ„æº
4. **è§†å›¾æ–‡ä»¶**ï¼šGo ä»£ç å·²åˆ›å»ºï¼Œä½†è¿˜éœ€è¦åˆ›å»ºå¯¹åº”çš„ HTML æ¨¡æ¿æ–‡ä»¶

## ğŸ“‹ ä¸‹ä¸€æ­¥å·¥ä½œ

- [ ] åˆ›å»ºç”¨æˆ·ç«¯çš„ HTML æ¨¡æ¿æ–‡ä»¶
- [ ] å®ç° RPC è°ƒç”¨è·å–çœŸå®æ•°æ®
- [ ] å®Œå–„ç”¨æˆ·è®¤è¯å’Œæƒé™æ§åˆ¶
- [ ] æ·»åŠ åŸŸåç®¡ç†çš„å®Œæ•´åŠŸèƒ½
- [ ] æ·»åŠ SSLè¯ä¹¦ç®¡ç†
- [ ] å®Œå–„ç»Ÿè®¡æ•°æ®å±•ç¤º

---

**æ–‡æ¡£ç‰ˆæœ¬**: 1.0.0
**æ›´æ–°æ—¶é—´**: 2025-10-31
